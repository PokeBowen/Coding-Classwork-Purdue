# We create our function, basically copied and pasted
calculate_letter_grades <- function(score) {
#unsubmitted hw/quiz/exam/project counts as 0 score
score[is.na(score)] <- 0
#Calculate component-wise scores according to the syllabus
hw.component = (score$HW_maxscore_100/100)*30
midterm.component = (score$Midterm_maxscore_50/50)*25
final.component = (score$Final_maxscore_50/50)*25
project.component=(score$Project_maxscore_100/100)*20
#Calculate total score
total = cbind(hw.component, midterm.component, final.component, project.component)
totalscore = apply(total,1,sum)
#Assign grades
grades = rep(NA,nrow(score))
for ( i in 1:nrow(score)){
if (totalscore[i]< 59) grades[i] = "F"
else if ((totalscore[i]>= 60) & (totalscore [i] <70)) grades[i] = "D"
else if ((totalscore[i]>= 70) & (totalscore [i] < 80)) grades[i] = "C"
else if ((totalscore[i]>= 80) & (totalscore [i] < 90)) grades[i] = "B"
else if ((totalscore[i]>= 90) & (totalscore [i] <100)) grades[i] = "A"
else grades[i] = "ERROR"
}
finalscore = cbind(as.character(score[,1]), totalscore, grades)
finalscore
}
# Read data
score <- read.csv("scores.csv", header = TRUE)
# Just calculate the grades
final_results <- calculate_letter_grades(score)
# Check our work
print(final_results)
Sigma <- matrix(c(10,3,3,2),2,2)
median(Sigma)
Sigma <- matrix(c(10,3,3,2),2,2)
apply(Sigma, 1, median)
Sigma <- matrix(c(10,3,3,2),2,2)
type(apply(Sigma, 1, median))
Sigma <- matrix(c(10,3,3,2),2,2)
typeof(apply(Sigma, 1, median))
Sigma <- matrix(c(10,3,3,2),2,2)
class(apply(Sigma, 1, median))
Sigma <- matrix(c(10,3,3,2),2,2)
list(apply(Sigma, 1, median))
Sigma <- matrix(c(10,3,3,2),2,2)
is.list(apply(Sigma, 1, median))
Sigma <- matrix(c(10,3,3,2),2,2)
medians <- apply(Sigma, 1, median)
is.list(medians)
medians
rowstat <- function(x){
apply(Sigma, 1, median)
}
Sigma <- matrix(c(10,3,3,2),2,2)
medians <- rowstat(Sigma)
is.list(medians)
Sigma <- matrix(c(10,3,3,2),2,2)
medians <- rowstat(Sigma)
is.list(medians)
rowstat <- function(x){
apply(Sigma, 1, median)
}
Sigma <- matrix(c(10,3,3,2),2,2)
rowstat(Sigma)
## Author: Anindya Bhadra
## STAT 545
## Example of code profiling and timing: for loop vs. apply()
##Clear workspace and load required libraries
rm(list=ls())
library(MASS)
pow=function(x,lambda){x^lambda}
## Write a function called "rowstat" using for loop to compute row mean and row sd of a matrix
rowstat=function(x){
rr=c(NA, length=nrow(x))
rrsq=c(NA, length=nrow(x))
for (i in 1:nrow(x))
{rr[i] = sum(x[i,])
rrsq[i]=sum(pow(x[i,],2))
}
list(mean=rr/ncol(x),sd=sqrt((rrsq - ncol(x)*(pow(rr/ncol(x),2)))/(ncol(x)-1)))
}
Sigma <- matrix(c(10,3,3,2),2,2)
## Generate 10,000 samples from a bivariate Normal distribution with mean 0 and covariance matrix Sigma
xx=mvrnorm(n=10000,c(0,0), Sigma)
## Call the function "rowstat"
pp=rowstat(xx)
## Do the same operations using apply
llm=apply(xx,1,mean)
lls=apply(xx,1,sd)
## Check that they give the same result
head (pp$mean)
head(llm)
head(pp$sd)
head(lls)
## Check the differences in time
system.time(rowstat(xx))
system.time(apply(xx,1,mean)) +  system.time(apply(xx,1,sd))
## Use Rprof() to profile the code. Is Rprof() useful here? Where is the maximum time being spent?
Rprof(interval=0.002)
pp=rowstat(xx)
Rprof(NULL)
summaryRprof()
## Author: Anindya Bhadra
## STAT 545
## Example of code profiling and timing: for loop vs. apply()
##Clear workspace and load required libraries
rm(list=ls())
library(MASS)
pow=function(x,lambda){x^lambda}
## Write a function called "rowstat" using for loop to compute row mean and row sd of a matrix
rowstat=function(x){
rr=c(NA, length=nrow(x))
rrsq=c(NA, length=nrow(x))
for (i in 1:nrow(x))
{rr[i] = sum(x[i,])
rrsq[i]=sum(pow(x[i,],2))
}
list(mean=rr/ncol(x),sd=sqrt((rrsq - ncol(x)*(pow(rr/ncol(x),2)))/(ncol(x)-1)))
}
Sigma <- matrix(c(10,3,3,2),2,2)
## Generate 10,000 samples from a bivariate Normal distribution with mean 0 and covariance matrix Sigma
xx=mvrnorm(n=10000,c(0,0), Sigma)
## Call the function "rowstat"
pp=rowstat(xx)
## Do the same operations using apply
llm=apply(xx,1,mean)
lls=apply(xx,1,sd)
## Check that they give the same result
head (pp$mean)
head(llm)
head(pp$sd)
head(lls)
## Check the differences in time
system.time(rowstat(xx))
system.time(apply(xx,1,mean)) +  system.time(apply(xx,1,sd))
## Use Rprof() to profile the code. Is Rprof() useful here? Where is the maximum time being spent?
Rprof(interval=0.002)
pp=rowstat(xx)
Rprof(NULL)
summaryRprof()
rowstat <- function(x){
apply(Sigma, 1, median)
}
rowstat <- function(x){
r_md <- c(NA, length=nrow(x))
for (i in 1:nrow(x))
{r_md[i] <- median(x[i,])
}
r_md
}
Sigma <- matrix(c(10,3,3,2),2,2)
rowstat(Sigma)
Sigma <- matrix(c(10,3,3,2),2,2)
rowstat(Sigma)
rowstat <- function(x){
apply(Sigma, 1, median)
}
Sigma <- matrix(c(10,3,3,2),2,2)
rowstat(Sigma)
rowstat <- function(x){
r_md <- c(NA, length=nrow(x))
for (i in 1:nrow(x))
{r_md[i] <- median(x[i,])
}
r_md
}
Sigma <- matrix(c(10,3,3,2),2,2)
rowstat(Sigma)
Sigma <- matrix(c(10,3,3,2),2,2)
medians <- rowstat(Sigma)
medians
rowstat <- function(x){
r_md <- c(NA, length=nrow(x))
for (i in 1:nrow(x))
{r_md[i] <- median(x[i,])
}
list(median = r_md)
}
Sigma <- matrix(c(10,3,3,2),2,2)
medians <- rowstat(Sigma)
medians
View(medians)
rowstat <- function(x){
r_md <- numeric(length=nrow(x))
for (i in 1:nrow(x))
{r_md[i] <- median(x[i,])
}
list(median = r_md)
}
Sigma <- matrix(c(10,3,3,2),2,2)
medians <- rowstat(Sigma)
medians
## Author: Anindya Bhadra
## STAT 545
## Example of code profiling and timing: for loop vs. apply()
##Clear workspace and load required libraries
rm(list=ls())
library(MASS)
pow=function(x,lambda){x^lambda}
## Write a function called "rowstat" using for loop to compute row mean and row sd of a matrix
rowstat <- function(x){
r_md <- numeric(length=nrow(x))
for (i in 1:nrow(x))
{r_md[i] <- median(x[i,])
}
list(median = r_md)
}
Sigma <- matrix(c(10,3,3,2),2,2)
## Generate 15,000 samples from a bivariate Normal distribution with mean 0 and covariance matrix Sigma
xx=mvrnorm(n=15000,c(0,0), Sigma)
## Call the function "rowstat"
pp=rowstat(xx)
## Do the same operations using apply
llm=apply(xx,1,median)
## Check that they give the same result
head (pp$mean)
head(llm)
## Check the differences in time
system.time(rowstat(xx))
system.time(apply(xx,1,median))
## Use Rprof() to profile the code. Is Rprof() useful here? Where is the maximum time being spent?
Rprof(interval=0.002)
pp=rowstat(xx)
Rprof(NULL)
summaryRprof()
## Author: Anindya Bhadra
## STAT 545
## Example of code profiling and timing: for loop vs. apply()
##Clear workspace and load required libraries
rm(list=ls())
library(MASS)
pow=function(x,lambda){x^lambda}
## Write a function called "rowstat" using for loop to compute row mean and row sd of a matrix
rowstat <- function(x){
r_md <- numeric(length=nrow(x))
for (i in 1:nrow(x))
{r_md[i] <- median(x[i,])
}
list(median = r_md)
}
Sigma <- matrix(c(10,3,3,2),2,2)
## Generate 15,000 samples from a bivariate Normal distribution with mean 0 and covariance matrix Sigma
xx=mvrnorm(n=15000,c(0,0), Sigma)
## Call the function "rowstat"
pp=rowstat(xx)
## Do the same operations using apply
llm=apply(xx,1,median)
## Check that they give the same result
head (pp$median)
head(llm)
## Check the differences in time
system.time(rowstat(xx))
system.time(apply(xx,1,median))
## Use Rprof() to profile the code. Is Rprof() useful here? Where is the maximum time being spent?
Rprof(interval=0.002)
pp=rowstat(xx)
Rprof(NULL)
summaryRprof()
## Author: Anindya Bhadra
## STAT 545
## Example of code profiling and timing: for loop vs. apply()
##Clear workspace and load required libraries
rm(list=ls())
library(MASS)
pow=function(x,lambda){x^lambda}
## Write a function called "rowstat" using for loop to compute row medians
rowstat <- function(x){
r_md <- numeric(length=nrow(x))
for (i in 1:nrow(x))
{r_md[i] <- median(x[i,])
}
list(median = r_md)
}
Sigma <- matrix(c(10,3,3,2),2,2)
## Generate 15,000 samples from a bivariate Normal distribution with mean 0 and covariance matrix Sigma
xx=mvrnorm(n=15000,c(0,0), Sigma)
## Call the function "rowstat"
pp=rowstat(xx)
## Do the same operations using apply
llm=apply(xx,1,median)
## Check that they give the same result
head (pp$median)
head(llm)
## Check the differences in time
system.time(rowstat(xx))
system.time(apply(xx,1,median))
## Use Rprof() to profile the code. Is Rprof() useful here? Where is the maximum time being spent?
Rprof(interval=0.002)
pp=rowstat(xx)
Rprof(NULL)
summaryRprof()
